# Stack - Default Training Configuration

# Policy architecture
policy:
  # Observation: 3 (rel pos) + 6 (rot6d) + 4 (joints) = 13
  obs_dim: 13
  image_size: 224

  # Action space: 3 (rel pos) + 6 (rot6d) + 4 (joints) = 13
  action_dim: 13
  action_repr: "relative_6d"  # "relative_6d" or "absolute_quat"
  action_horizon: 16   # Predict 16 future timesteps
  prediction_horizon: 16
  obs_horizon: 2       # Condition on 2 past observations

  # Diffusion
  num_diffusion_steps: 100
  beta_schedule: "squaredcos_cap_v2"

  # Network
  hidden_dim: 64
  num_layers: 4

  # Training
  batch_size: 64
  learning_rate: 1.0e-4
  num_epochs: 100
  freeze_backbone: true

# Data
data:
  train_dir: "data/processed/train"
  val_dir: "data/processed/val"
  image_size: 224
  # Augmentation
  random_crop: true
  color_jitter: true

# Training
training:
  seed: 42
  num_workers: 4
  gradient_clip: 1.0
  ema_decay: 0.995
  checkpoint_every: 25
  eval_every: 5
  early_stopping_patience: 10

# Logging
logging:
  wandb:
    enabled: false
    project: "stack"
    entity: null
    log_images_every: 10   # Sample prediction images every N epochs (0=disable)
    log_artifacts: true    # Upload best checkpoint as wandb Artifact
  tensorboard: true
